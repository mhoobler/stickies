!function(){const e=async()=>new Promise(((e,t)=>{var o,n=indexedDB.open("stickiesDB",1);n.onerror=e=>{console.error("IndexedDB error"),t("Error with creating request")},n.onsuccess=async t=>{console.log(t),(o=t.target.result).onerror=e=>{console.error("Database error: "+e.target.errorCode)};try{const t=(await(async e=>new Promise(((t,o)=>{var n=e.transaction(["stickies"],"readwrite");n.oncomplete=e=>{console.log("transaction success",e)},n.onerror=e=>{console.error("transaction error",e)},n?t(n):o("Error with creating transaction")})))(o)).objectStore("stickies");e({store:t})}catch(e){console.log(e)}},n.onupgradeneeded=e=>{var t=e.target.result.createObjectStore("stickies",{autoIncrement:!0,keyPath:"id"});t.createIndex("id","id",{unique:!0}),t.createIndex("message","message",{unique:!1}),t.createIndex("color","color",{unique:!1}),t.createIndex("left","left",{unique:!1}),t.createIndex("top","top",{unique:!1})}})),t=document.getElementById("color-select"),o=document.getElementById("color-options"),n=document.getElementById("sticky-container"),r=document.getElementById("trash"),s=document.getElementById("trash-path");document.getElementById("hidden");function c({id:t,color:o,top:n,left:r,message:s}){e().then((e=>{const c=e.store.put({id:t,color:o,top:n,left:r,message:s});c.onsuccess=e=>{console.log(e.target.result)},c.onerror=e=>{console.log(e)}})).catch((e=>console.error(e)))}document.body.removeChild;function*l(){let e=0;for(;;)yield e++}var a=l();document.getElementById("reset").addEventListener("click",(()=>{const e=[...document.querySelectorAll(".sticky")];for(let t of e)t.style.zIndex=0;a=l()}));const d={selectedColor:()=>t.getAttribute("data-color"),showingOptions:()=>!o.classList.contains("hidden"),zIndex:()=>a.next().value,getOffset:e=>{var{top:t,left:o}=e.style;return{top:t=parseInt(t.slice(0,-2)),left:o=parseInt(o.slice(0,-2))}},dragging:null};function i(e){const{tag:t,classList:o,id:n,value:r,style:s,dataset:c}=e,l=document.createElement(t);if(o&&(l.classList=o),n&&(l.id=n),r&&(l.value=r),s)for(let e of Object.keys(s))l.style[e]=s[e];if(c)for(let e of Object.keys(c))l.dataset[e]=c[e];return l}function u(e,t,o,n=null,r=null){const s=i({tag:"div",classList:"sticky",style:{top:"string"==typeof t?t:t+"px",left:"string"==typeof o?o:o+"px",zIndex:d.zIndex()},dataset:{id:e,color:n||d.selectedColor()}}),l=i({tag:"div"}),a=i({tag:"textarea",value:r});return a.onkeydown=((e,t=1e3)=>{let o;return n=>{clearTimeout(o),o=setTimeout((()=>{e(n)}),t)}})((e=>{const t=e.target.parentElement,{top:o,left:n}=t.style,{id:r,color:s}=t.dataset,{value:l}=e.target;c({id:parseInt(r),top:o,left:n,color:s,message:l})})),s.appendChild(l),s.appendChild(a),s.draggable,s.addEventListener("touchmove",f),s.addEventListener("mousedown",g),s}function g(e){if(e.currentTarget.style.zIndex=d.zIndex(),"TEXTAREA"!==e.target.tagName){const o=e.currentTarget;d.dragging=o;const{top:n,left:r}=d.getOffset(o),s=r-e.pageX,l=n-e.pageY;function t(e){o.style.top=l+e.pageY+"px",o.style.left=s+e.pageX+"px"}o.addEventListener("mousemove",t),o.addEventListener("mouseup",(function e(n){d.dragging=null;const r=n.currentTarget.querySelector("textarea").value,{top:s,left:l}=n.currentTarget.style,{id:a,color:i}=n.currentTarget.dataset;c({id:parseInt(a),top:s,left:l,message:r,color:i}),o.removeEventListener("mousemove",t),o.removeEventListener("mouseup",e)}))}}var p,m;function f(e){d.dragged=e.currentTarget,e.currentTarget.style.top=e.targetTouches[0].pageY+"px",e.currentTarget.style.left=e.targetTouches[0].pageX+"px",touchTarget=e}function v(e){s.style.fill=""}t.addEventListener("mouseup",(function(e){console.log("c"),p&&clearTimeout(p);const t=e.target.dataset.color;e.currentTarget.setAttribute("data-color",t),o.classList.toggle("hidden")})),t.addEventListener("mousedown",(function(t){p=setTimeout((()=>{const o=u(t.pageY,t.pageX);function r(e){o.style.top=e.pageY+"px",o.style.left=e.pageX+"px"}n.appendChild(o),d.dragging=o,document.addEventListener("mousemove",r),document.addEventListener("mouseup",(function t(o){d.dragging=null,function({color:t,top:o,left:n}){e().then((e=>{const r=e.store.add({color:t,top:o,left:n,message:""});r.onsuccess=e=>{console.log(e.target.result)},r.onerror=e=>{console.log(e)}})).catch((e=>console.error(e)))}({top:o.pageY,left:o.pageX,color:d.selectedColor()}),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",t)}))}),200)})),t.addEventListener("touchstart",(function(e){const o=u(0,0);console.log(o),m=e=>function(e,t){t.style.top=e.targetTouches[0].pageY+"px",t.style.left=e.targetTouches[0].pageX+"px"}(e,o),t.addEventListener("touchmove",m),n.appendChild(o)})),t.addEventListener("touchend",(function(e){console.log(e),t.removeEventListener("touchmove",m)})),r.addEventListener("mouseenter",(function(e){d.dragging&&(s.style.fill="#F33")})),r.addEventListener("mouseleave",v),r.addEventListener("mouseup",(function(t){if(d.dragging){let t=window.confirm("Are you sure you want to delete this?");console.log(t),t&&(o=d.dragging.dataset.id,e().then((e=>{const t=e.store.delete(parseInt(o));t.onsuccess=e=>{console.log(e.target.result)},t.onerror=e=>{console.log(e)}})).catch((e=>console.error(e))),d.dragging.remove(),d.dragging=null,s.style.fill="")}var o})),r.addEventListener("touchstart",(e=>{s.style.fill="#F33"})),r.addEventListener("touchend",(e=>{s.style.fill=""})),e().then((e=>{const t=e.store.getAll();t.onsuccess=e=>{const t=e.target.result;for(let e of t){let t=u(e.id,e.top,e.left,e.color,e.message);n.appendChild(t)}},t.onerror=e=>{console.log(e)}})).catch((e=>console.error(e)))}();
//# sourceMappingURL=index.e8467d5e.js.map
